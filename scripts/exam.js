const questions = [
  {
    question: "The purpose of a batter board in concrete Work is:",
    options: [
      "to use when mixing concrete",
      "as a wood support in a concrete form",
      "as a part of a wood shoring system",
      "to support layout strings when locating foundations",
    ],
    answer: 3,
    explanation: "在建筑施工过程中，特别是在建造砖墙、围栏等结构时，“打板”（batter boards）扮演着重要的角色。它们帮助确保建筑物的位置和外观与设计图纸一致。\n\n以下是打板的主要功能：\n\n1. 确定地基位置：在建造任何结构之前，准确的测量和标定地点是非常重要的。打板位于工地外围，在原计划的墙面位置以一定距离设置。\n\n2. 支持布局弦线：使用绳索或缆线，通过打板上的孔眼拉紧，形成所谓的“弦线”（layout lines）。这些弦线标示出墙面在地面上的确切轮廓和位置。它们帮助工人了解建筑结构应该如何对齐。\n\n3. 精准测量：通过在打板上绘制弦线，施工团队可以确保墙体的对齐和高度符合设计要求。这种方法使得建筑物即便在不同方向或角度上也能保持一致性。\n\n4. 提供参考：打板作为固定的标识，帮助施工人员在整个施工过程中保持对齐和测量的准确性。即使随着施工进行，地面条件或其他因素发生变化，它们也能提供一个稳定的参考。\n\n综上所述，打板在建筑施工中的主要目的是在确定地基位置时，支持布局弦线。这一功能对于保证结构的准确性和设计一致性至关重要。"
  },
  {
    question: "Which of the following is the smallest Romex cable?",
    options: ["30 Gauge", "10 Gauge", "14 Gauge", "16 Gauge"],
    answer: 2,
    explanation: "在美国，Romex® 是一种非金属型综合用线（NM）电缆的品牌名字，通常用于建筑施工中。这些电缆的尺寸通过“号码”来表示，与其直径或能够承载的最大电流有关。\n\n在美国标准中，Romex® 电缆的尺寸编号（如12/2、14/2等）通常用于描述电线的规格。这个号码表示所包含导体的大小：\n\n- 12 号：是较大的电线。\n- 14 号：比 12 号小，因此它具有更细的导体。\n\n因此，当你看到“14 号”时，这意味着使用了相对较细的导体。在给定的选项中，“14 号”是最小的电缆尺寸。这个号码表示导体直径越小，其承载电流量也越小，并且通常用于低功率需求场合。所以，对于Romex® 电缆来说，“14 号”是最小的选项之一。\n\n因此答案是：14 号（Gauge）是最小的 Romex® 电缆尺寸。"
  },
  {
    question:
      "Which of the following may approve a change order on a public works project?",
    options: ["Contractor", "City", "Subcontractor", "CSLB"],
    answer: 1,
    explanation: "在公共工程项目中，变更令是一种用于修改原始合同条款（如工期、费用或范围）的文件。批准变更令通常需要由拥有相应权力和责任的官方实体来进行。\n\n市政府是负责管理和控制城市内公共服务项目（如道路建设、公用事业改进等）的机构。在大多数情况下，市政府确实有权批准对其监管范围内的公共工程项目的变更令。\n\n以下是为何市政府可以批准这些变更令：\n\n1. 合同签订方：市政庩通常是与施工公司签约的一方，因此它有权修改或调整合同内容。\n\n2. 项目管理职责：市政府负责监督和管理公共工程项目，并确保其符合预算、安全标准以及其他相关规范。\n\n3. 法律权力：根据当地的法律和条例，市政府通常被赋予了对城市内公共工程项目变更令的审批权。\n\n因此，在大多数情况下，如果一个公共工程项目是由市政府资助、管理或监督的，则市政府确实有能力批准该项目的变更令。不过，具体的流程和权限可能因地区而异，并且通常需要遵循既定的程序。\n\n综上所述，正确答案是：市政府可以批准公共工程项目的变更令。"
  },
  {
    question: "What is the minimum height of a staircase handrail?",
    options: ['24"', '34"', '38"', '42"'],
    answer: 1,
    explanation: "根据美国建筑和安全标准，特别是《2017年美国残疾人法》（ADA）和《国家火灾协会（NFPA）101生命安全代码》，楼梯扶手的高度规定具有一定的标准。\n\n34英寸是通常接受的最低高度标准：\n\n1. ADA 标准：根据 ADA（《美国残疾人法》），扶手应位于36至38英寸处，以确保其对大多数用户都易于使用。\n\n2. NFPA 101 生命安全代码：这一标准规定了楼梯的扶手高度必须在30到34英寸之间。其中34英寸是最常被采用的，以满足大多数成人的需求。\n\n3. 国际建筑代码（IBC）：与 NFPA 类似，IBC 也规定楼梯扶手高度应为30至34英寸之间。\n\n因此，虽然不同标准可能有些许差异，但在美国大多数情况下，34 英寸是一个普遍接受的最低楼梯扶手高度。这个高度被认为能够满足绝大多数人群对安全和便利性的需求。\n\n总结来说，34英寸是一个标准化的最低楼梯扶手高度，旨在提供一定程度的安全保障和方便。"
  },
  {
    question: "What is the minimum openable area for a window that is to be used as an escape window?",
    options: [
      "4 square feet",
      "5.7 square feet",
      "6 square feet",
      "8.2 square feet",
    ],
    answer: 1,
    explanation: "根据美国《2018年国家火灾协会（NFPA）101生命安全代码》以及其他相关建筑标准，用作逃生窗的窗户确实需要符合一定的最小可开启面积要求。这些规定是为了确保在火灾或紧急情况下，居民能够安全快速地通过窗户逃生。\n\n5.7平方英尺（约0.53平方米）是通常用作标准的最小可开启面积。这一规定有以下具体要求：\n\n1. 单层楼宇：对于不超过三层高度的住宅，逃生窗户的最小可开启面积为5.7平方英尺。\n\n2. 多层建筑物：在更高的建筑中，如四层或更多楼层的住宅，要求可能会更严格，通常需要一个可开启面积为8平方英尺或以上。\n\n3. 其他考虑因素：除了最小可开启面积之外，逃生窗还必须符合一定的高度要求（最低24英寸到44英寸的窗台高），以及宽度和高度允许人体通过的空间。\n\n这些规定确保即便在紧急情况下，特别是火灾发生时，居民可以安全有效地逃离建筑物。因此，在设计和检查住宅或其他类型房产时，符合这些标准是至关重要的。\n\n综上所述，用作逃生窗的最小可开启面积通常为5.7平方英尺（约0.53平方米），以满足安全出口需求。"
  },
  {
    question: "All reportable occupational injuries and illnesses are submitted on Cal/OSHA Form 5020 within:",
    options: ["24 hours", "48 hours", "Three days", "Five days"],
    answer: 3,
    explanation: "根据加利福尼亚州职业安全与健康管理局（Cal/OSHA）的规定，任何雇主在发生工伤或与职业相关的疾病时都有责任进行报告。具体来说：\n\n- 所有应报告的事件：必须在五个工作日内向 Cal/OSHA 填写并提交表格 5020（“报告工伤和职业病”）。\n\n这意味着如果雇主知道或怀疑有工人因工伤或职业相关的疾病而受伤，无论是入院、死亡、失去四只手指以上（不包括拇指）、残废等情况，均需要在发生后的五个工作日内完成报告。\n\n因此，正确答案是：所有应报告的工伤和疾病都必须在五天内报告给 Cal/OSHA 表格 5020。\n\n值得注意的是，对于一些特别严重的事件（如死亡或需要入院治疗超过五小时），还有更紧迫的报告要求。例如：\n\n- 死亡：必须在24小时内进行报告。\n- 严重伤害：可能导致失去四只手指以上、残废或需要入院治疗超过五小时的伤害，也必须在8小时内报告。\n\n这些规定是为了确保工作场所的安全和健康管理得到及时处理。"
  },
  {
    question:
      'A contractor installs a handrail along a stairway. The handrail is 1-5/8" in diameter and is installed 1-3/4" from the wall. Based on this installation, does the handrail meet building codes?',
    options: [
      "Yes",
      'No, the handrail should be 1-3/4" in diameter and installed 2" from the wall',
      'No, the handrail should be 2" in diameter and installed 2" from the wall',
      'No, the handrail should be 1" in diameter and installed 1-1/2" from the wall',
    ],
    answer: 0,
    explanation: "要判断楼梯扶手的安装是否符合美国建筑规范（通常是由《2018年国际建筑代码》（IBC）和《2010年美国残疾人法》（ADA）等标准制定），我们需要考虑以下关键要素：\n\n1. 扶手的直径：根据 ADA 标准，楼梯的主要扶手（也被称为“安全”或“生命”扶手）必须具有一定的尺寸。对于圆柱形扶手，直径必须在1-1/4英寸到2英寸之间。因此，直径为1-5/8英寸的扶手符合这个要求。\n\n2. 扶手与墙体距离：根据 IBC 和 ADA 的规定，主要扶手应安装在离墙面至少1-1/4英寸的位置。因此，1-3/4英寸的距离也符合这一标准。\n\n综上所述，基于直径和与墙体的距离来看，该扶手是符合建筑规范要求的。因此，在这种安装方式下：\n\n答案是：是，该扶手符合建筑规范。\n\n需要注意的是，对于其他类型的扶手（例如侧扶手、次级或非生命安全扶手）和特定情况可能有不同的要求。此外，一些地方政府还可能会有自己的补充规范，因此在实际施工时应检查相关地区的具体法规。"
  },
  {
    question:
      "If Eric is selling or negotiating contracts at a client’s home and does not hold a Home Improvement Salesperson Registration, what kind of charge can the Registrar of Contractors impose on Eric?",
    options: [
      "Fine of $5,000",
      "120 days in county jail",
      "Misdemeanor",
      "Felony",
    ],
    answer: 2,
    explanation: "在加利福尼亚州，任何从事家庭装修行业或与此相关的销售和谈判合同时，必须遵守《加州承包商法典》（California Business and Professions Code）以及《加州承包商注册局》（Contractors State License Board, CSLB）的规定。根据这些法律要求：\n\n1. 家庭装修销售人员：如果某个人从事与家庭装修相关的销售活动或合同谈判，那么他们通常需要具备特定的注册资格。这包括在业务中参与谈判、签署或销售价值达到一定数额（目前为$500美元及以上）的家庭装修工程。\n\n2. 未持有资格销售人员：如果 Eric 在客户家中进行销售或谈判合同，而没有获得必要的家庭装配销售人员注册资格，则可能违反了相关法规。\n\n3. 指控类型：根据加州法律，如果一个未经注册的个体从事需要注册才能合法进行的行为，他们可能会面临轻罪（misdemeanor）指控。这涉及违反《加州承包商法典》，具体来说可能是第7026条，该条款规定未持有适当许可证或资格的情况下从事建筑行业工作为非法。\n\n因此，如果 Eric 在没有合法注册资格的情况下进行家庭装修销售活动或合同谈判，承包商注册局（CSLB）可以对他提出轻罪指控。这些指控可能会带来处罚，如罚款、刑事记录等。\n\n总结：Eric 可以被指控轻罪，因为他在没有持有家庭装修销售人员注册资格的情况下进行销售或谈判合同活动。"
  },
  {
    question: "Refer to the diagram. Identify the jumper connecting the neutral busbar to the metal of the distribution box.",
    options: [
      "System bonding jumper",
      "Main bonding jumper",
      "Grounding rod jumper",
      "Feeders tap jumper",
    ],
    image: "imgId07019C10P",
    answer: 1,
    explanation: "在提供的示意图中，主接地跳线（Main Bonding Jumper） 是将 中性线汇流排（Neutral Bus Bar） 连接到 接地螺丝（Ground Screw） 的导线，而接地螺丝固定在配电箱的金属外壳上。\n\n解释：\n- 中性线汇流排（Neutral Bus Bar）： 这是用于连接电路中性线的汇流排。\n- 接地螺丝（Ground Screw）： 用于将接地系统与金属配电箱外壳连接。\n- 主接地跳线（Main Bonding Jumper，MBJ）： 这是一根导线或金属条，它连接中性线汇流排与接地螺丝，确保金属外壳与中性线系统接地相连。\n\n在示意图中，连接中性线汇流排与接地螺丝的红色导线 就是 主接地跳线，它的作用是提供故障电流的回路，确保电气安全，并防止触电危险。"
  },
  {
    question: 'What is the minimum distance for "Y"?',
    options: ["8 in", "12 in", "18 in", "24 in"],
    image: "imgFbId01010E",
    answer: 2,
    explanation: "图中标注的“Y”表示从结构梁的底部到地面或基础顶部的垂直间隙。在建筑和工程规范中，通常要求此最小间隙为 18英寸，主要是为了：\n\n1. 方便检查和维护： 足够的空间可以让工人进行必要的检查和维修。\n2. 防潮和通风： 适当的间隙有助于空气流通，防止湿气积聚，从而减少木材腐蚀或钢材锈蚀的风险。\n3. 布置管线： 在施工过程中，这个空间可以用于布设电缆或管道，确保安装的灵活性。\n4. 结构稳定性： 使梁和基础之间保持适当的距离，防止直接接触地面造成的损坏或变形。\n\n因此，确保“Y”至少为 18英寸 是符合工程实践和建筑标准的要求。"
  },
];

const translations = [
  {
    question: "混凝土工程中打板的目的是：",
    options: [
      "搅拌混凝土时使用的",
      "作为混凝土结构中的木材支撑",
      "作为木护栏系统的一部分",
      "在确定地基位置时，支持布局弦线",
    ],
  },
  {
    question: "以下哪个是最小的Romex电缆？",
    options: ["30 号", "10 号", "14 号", "16 号"],
  },
  {
    question: "以下哪项可以批准公共工程项目的变更令？",
    options: ["承包商", "市政府", "分包商", "CSLB"],
  },
  {
    question: "楼梯扶手的最低高度是多少？",
    options: ["24英寸", "34英寸", "38英寸", "42英寸"],
  },
  {
    question: "用作逃生窗的窗户最小可开启面积是多少？",
    options: ["4平方尺", "5.7 平方英尺", "6 平方英尺", "8.2 平方英尺"],
  },
  {
    question:
      "所有应报告的工伤和疾病都应该在在多长时间之内报告给Cal/OSHA表格5020？",
    options: ["24小时", "48小时", "三天", "五天"],
  },
  {
    question:
      "一个承包商沿着楼梯安装扶手。扶手的直径为1-5/8英寸，安装在离墙1-3/4英寸的地方。根据这种安装方式，该扶手是否符合建筑规范？",
    options: [
      "是",
      "不，扶手的直径应该是1-3/4英寸，安装在离墙2英寸的地方。",
      "不，扶手的直径应该是2英寸，安装在离墙2英寸的地方。",
      "不，扶手的直径应该是1英寸，安装在离墙1-1/2英寸的地方。",
    ],
  },
  {
    question:
      "如果Eric在客户家中进行销售或谈判合同，并且没有持有家庭装修销售人员的注册资格，那么承包商注册局可以对Eric提出什么样的指控？",
    options: ["罚款5,000美元", "在县级监狱服刑120天", "轻罪", "重罪"],
  },
  {
    question: "参照图示。确定连接中性母线和配电箱金属的跳线。",
    options: ["系统粘合跳线", "主键合跳线", "接地棒跳线", "供料器分接跳线"],
  },
  {
    question: '"Y"的最小距离是多少？',
    options: ["8英寸", "12英寸", "18英寸", "24英寸"],
  },
];

Vue.createApp({
  data() {
    return {
      studyMode: true,
      questions,      // assuming these are defined elsewhere or imported
      translations,   // assuming these are defined elsewhere or imported
      imageLocation: null,
      currentIndex: 0,
      selectedOptions: {},
      flaggedQuestions: [],
      translate: false,
      // New properties for typewriter effect:
      displayedExplanation: "",
      explanationTaskId: 0, // helps cancel previous typing tasks if needed
    };
  },
  methods: {
    goToQuestion(index) {
      this.currentIndex = index;
    },
    changeMode() {
      this.studyMode = !this.studyMode;
    },
    selectOption(index) {
      this.selectedOptions[this.currentIndex] = index;
    },
    back() {
      if (this.currentIndex > 0) this.currentIndex--;
    },
    next() {
      if (this.currentIndex < this.questions.length - 1) this.currentIndex++;
      else if (!this.studyMode) {
        this.currentIndex = 0;
        this.studyMode = true;
      }
    },
    getAnswerIndicator(index) {
      if (!this.studyMode) return "";
      if (this.selectedOptions[this.currentIndex] === undefined) return "";
      return this.questions[this.currentIndex].answer === index
        ? "text-success"
        : "text-danger";
    },
    getQuestionNumIndicator(index) {
      if (!this.studyMode) return "";
      if (this.selectedOptions[index] === undefined) return "";
      return this.questions[index].answer === this.selectedOptions[index]
        ? "green-bg"
        : "red-bg";
    },
    showTranslations() {
      this.translate = !this.translate;
    },
    flag() {
      if (this.flaggedQuestions.includes(this.currentIndex)) {
        this.flaggedQuestions = this.flaggedQuestions.filter(
          (q) => q !== this.currentIndex
        );
      } else {
        this.flaggedQuestions.push(this.currentIndex);
      }
    },
    // The async method that builds the explanation text one character at a time.
    async typeExplanation() {
      // Increment the task ID to cancel any previous run
      const taskId = ++this.explanationTaskId;
      this.displayedExplanation = "";
      const explanation = this.questions[this.currentIndex].explanation;
      // Loop over each character and append with a delay
      for (const char of explanation) {
        // If a new typing task has started, stop this one.
        if (this.explanationTaskId !== taskId) break;
        this.displayedExplanation += char;
        await new Promise((resolve) => setTimeout(resolve, 50)); // delay in ms (adjust as desired)
      }
    },
  },
  // A watcher to trigger the typewriter effect whenever currentIndex changes.
  watch: {
    currentIndex() {
      this.typeExplanation();
    },
  },
}).mount("#exam");

